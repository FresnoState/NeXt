<div class="profile">

  <h2><%= @idea.name %></h2>

  <div class="row">

    <div class="col-lg-9 col-sm-8">

      <div class="subtitle">
        <%= raw @idea.pitch_html %>
      </div>

      <%= raw @idea.description_html %>

    </div>

    <div class="col-lg-3 col-sm-4">

      <section class="panel panel-invisible">

        <% unless @idea.has_been_voted_for_by? context.user %>

        <%= button_to 'Good Idea',
                      idea_votes_url(@idea),
                      method: :post,
                      params: { participate: false },
                      class: 'btn btn-info btn-block',
                      form_class: 'button_to full-width' %>

        <%= button_to 'Would Participate',
                      idea_votes_url(@idea),
                      method: :post,
                      params: { participate: true },
                      class: 'btn btn-success btn-block',
                      form_class: 'button_to full-width' %>

        <% end %>

        <% if @idea.is_editable_by? context.user %>
        <%= button_to 'Edit', edit_idea_url(@idea), class: 'btn btn-warning btn-block', form_class: 'button_to full-width' %>
        <% end %>

      </section>

      <section class="panel panel-default">
        <header class="panel-heading">
          <h4 class="panel-title">Status</h4>
        </header>
        <div class="panel-body">
          <p><%= @idea.idea_status.name %></p>
        </div>
      </section>

      <% if @idea.idea_roles.founders.count > 0 %>

        <section class="panel panel-default">
          <header class="panel-heading">
            <h4 class="panel-title">Founders</h4>
          </header>
          <div class="panel-body">
            <ul>
              <% @idea.idea_roles.founders.each do |idea_role| %>
                <li><%= link_to idea_role.user.display_name, idea_role.user %></li>
              <% end %>
            </ul>
          </div>
        </section>

      <% end %>

      <%
      votes_count = @idea.idea_votes.count
      if votes_count > 0 %>

        <section class="panel panel-default">
          <header class="panel-heading">
            <h4 class="panel-title">Supporters</h4>
          </header>
          <div class="panel-body">
            <ul>
              <% @idea.idea_votes.take(5).each do |idea_vote| %>
                <li><%= link_to idea_vote.user.display_name, idea_vote.user %></li>
              <% end %>
            </ul>
          </div>
        </section>

      <% if votes_count > 5 %>
      <p><em><%= link_to 'See More...', '#' %></em></p>
      <% end %>

      <% end %>

    </div>

  </div>

</div>


